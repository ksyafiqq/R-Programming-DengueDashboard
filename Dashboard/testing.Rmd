---
title: "Interactive Dashboard for Dengue Cases in Pahang"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    social: ["twitter", "facebook", "menu"]
---

```{r setup, include=FALSE}
library(flexdashboard)
library(knitr)
library(DT)
library(ggplot2)
library(plotly)
library(dplyr)
library(openintro)
library(highcharter)
library(ggvis)
library(geojsonio)
library(sf)
library(cartography)
library(leaflet)
library(sf)
library(tidyverse)
library(haven)
library(fpp2)
library(lubridate)
library(nnet)
library(forecast)
```

```{r}

mydata <- read.csv("C:/Users/muham/Documents/UMP/Sem7/FYP2/Dataset/DataDenggiPahangLatest.csv")

mydata2 <- read.csv("C:/Users/muham/Documents/UMP/Sem7/FYP2/Dataset/death.csv")

mydata3 <- read.csv("C:/Users/muham/Documents/UMP/Sem7/FYP2/Dataset/GeneralData.csv")

mydata4 <- read.csv("C:/Users/muham/Documents/UMP/Sem7/FYP2/Dataset/CasesbyLocation.csv") 

```

```{r}

mycolors <- c("green", "#FFC125", "darkgreen", "darkorange")
```

Main Page
===================================

Row
-----------------------------------


### All data retrieved on Jabatan Kesihatan Negeri Pahang Facebok Page

```{r}
valueBox(paste("Total Dengue Cases in Pahang"),
          color = "warning")

```

-----------------------------------------------------------------------

### **Total Cases**

```{r}
valueBox(length(mydata$District)
         , color = "black")
```

### **Total Death**

```{r}
valueBox(length(mydata2$Death)
         , color = "red")
```

Row
------------------------------------------------------------------------

### Cases by District
```{r}
p1 <- mydata %>%
          group_by(District) %>%
          summarise(count = n()) %>%
          plot_ly(x = ~District,
                 y = ~count,
                 color = "orange",
                 type = 'bar') %>%
layout(xaxis = list(),
yaxis = list(title = 'Count'))
p1
                  
```

### Location that reach 100 cases and above
```{r}
p2 <- mydata %>%
          group_by(District) %>%
          summarise(count = n()) %>%
          filter(count>100) %>%
          plot_ly(labels= ~District,
                 values = ~count,
                 marker = list(colors = mycolors)) %>%
          add_pie(hole = 0.4) %>%
          layout(xaxis = list(zeroline = F,
                              showline = F,
                              showticklabels = F,
                              showgrid = F),
                 yaxis = list(zeroline = F,
                              showline = F,
                              showticklabels = F,
                              showgrid = F))
p2
                  
```

Row
---------------------------------------

### Month vs Cases
```{r}
freq <- length(mydata3$Date)

mydata3$Date <- as.Date(mydata3$Date)
rcntData <- ts(mydata3[,2], start = c(2020, 6), frequency = freq)

p3 <- autoplot(rcntData) + 
  ggtitle("Time Plot: Dengue Cases in 2020") +
  ylab("Number of Cases")

p3
                  
```

Map
============================================

### Map

```{r}

mydata <- mydata %>% mutate(popup_info = paste(Location, "<br/>", District, "<br/>"))

colors <- c("green", "red")

pal <- colorFactor(colors, mydata4$Total.Cases)

map <- leaflet()%>%
  addTiles() %>%
  addCircleMarkers(data=mydata, 
                   lat = ~Lat,
                   lng = ~Long, 
                   popup = ~popup_info, 
                   color = ~pal(mydata4$Total.Cases)) 



map 

```

Future Dengue Cases 
============================================

### Future Trend of Dengue Cases in Pahang

still in development
```{r}



```

Data Table
========================================

```{r}
datatable(mydata,
          caption = "Dengue Data",
          rownames = T,
          filter = "top",
          options = list(pageLength = 25))
```

Summary {data-orientation=columns} 
===========================================

Column 
-----------------------------------

### **Cases in Cameron Highlands**

```{r}

valueBox(sum(mydata$District == "Cameron Highlands"),
         color = "#a2bfcc")

```


### **Cases in Lipis**

```{r}

valueBox(sum(mydata$District == "Lipis"),
         color = "#4fb08f")
```

### **Cases in Raub**

```{r}

valueBox(sum(mydata$District == "Raub"),
         color = "#bfc45a")
```

### **Cases in Jerantut**

```{r}

valueBox(sum(mydata$District == "Jerantut"),
         color = "#d8d227")
```

### **Cases in Bentong**

```{r}

valueBox(sum(mydata$District == "Bentong"),
         color = "#0985c6")
```

### **Cases in Temerloh**

```{r}

valueBox(sum(mydata$District == "Temerloh"),
         color = "#9f3931")
```


### **Cases in Bera**

```{r}

valueBox(sum(mydata$District == "Bera"),
         color = "#dfba21")
```

### **Cases in Maran**

```{r}

valueBox(sum(mydata$District == "Maran"),
         color = "#b4112d")
```

Column
---------------------------

### **Cases in Kuantan**

```{r}

valueBox(sum(mydata$District == "Kuantan"),
         color = "#8b0000")
```

### **Cases in Pekan**

```{r}

valueBox(sum(mydata$District == "Pekan"),
         color = "#995a85")
```

### **Cases in Rompin**

```{r}

valueBox(sum(mydata$District == "Rompin"),
         color = "#604b5b")
```

### **Total Cases in Pahang**

```{r}
valueBox(length(mydata$District)
         , color = "black")
```

### **Total Death**

```{r}
valueBox(length(mydata2$Death)
         , color = "red")
```

Column
---------------------------

**_Report_**

Data was took from Official Facebook Page of Jabatan Kesihatan Negeri Pahang

[JKN Pahang Facebook](https://www.facebook.com/jknphg/)





_This report was generated on `r format(Sys.Date(), format = "%B %d, %Y")`._